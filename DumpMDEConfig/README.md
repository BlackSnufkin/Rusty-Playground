# DumpMDEConfig :shiled:

## Description
This tool enumerates Microsoft Defender, it identifying exclusion paths, allowed threats, protection history and ASR (Attack Surface Reduction) rules enabled on the system. No admin privileges required.

## Usage
Run the executable to list the Microsoft Defender Configuration.

## Example
```txt

PS C:\Users\L.Ackerman\Desktop\Development\Rusty-Playground\DumpMDEConfig> whoami /priv

PRIVILEGES INFORMATION
----------------------

Privilege Name                Description                          State
============================= ==================================== ========
SeShutdownPrivilege           Shut down the system                 Disabled
SeChangeNotifyPrivilege       Bypass traverse checking             Enabled
SeUndockPrivilege             Remove computer from docking station Disabled
SeIncreaseWorkingSetPrivilege Increase a process working set       Disabled
SeTimeZonePrivilege           Change the time zone                 Disabled

PS C:\Users\L.Ackerman\Desktop\Development\Rusty-Playground\DumpMDEConfig> .\target\x86_64-pc-windows-msvc\release\DumpMDEConfig.exe
[+] Exclusion Path: C:\Users\L.Ackerman\Desktop
[!] Time Created: 2024-06-03 08:53:30.527790700 UTC

[+] ASR Rule Triggered: 7674ba52-37eb-4a4f-a9a1-f0f9a1619a2c - (Prevent Adobe Reader from creating child processes)
[!] Time Created: 2024-06-07 08:57:42.596451100 UTC

[+] Allowed Threats of the system:
+------------+----------------------------+--------------------------------------------------+-----------------------------------+
| ThreatID   | Tool Name                  | Path                                             | Time Created                      |
+------------+----------------------------+--------------------------------------------------+-----------------------------------+
| 2147729891 | HackTool:Win32/Mimikatz.D  | file:_C:\Users\L.Ackerman\Documents\mimikatz.exe | 2024-06-07 11:49:04.508103200 UTC |
+------------+----------------------------+--------------------------------------------------+-----------------------------------+
| 2147756241 | VirTool:Win32/Kekeo.A!MTB  | file:_C:\Users\L.Ackerman\Documents\Rubeus.exe   | 2024-06-07 12:21:26.140346600 UTC |
+------------+----------------------------+--------------------------------------------------+-----------------------------------+


[+] Defender Protection History:
+---------------------------------------+----------+---------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+-----------------------------------+
| Threat Name                           | Severity | Category            | Path                                                                                                                                                                                                            | Action Taken   | Time Created                      |
+---------------------------------------+----------+---------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+-----------------------------------+
| HackTool:Win32/Mimikatz.D             | High     | Tool                | file:_C:\Users\L.Ackerman\Documents\mimikatz.exe                                                                                                                                                                | Not Applicable | 2024-06-07 11:48:31.838531900 UTC |
+---------------------------------------+----------+---------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+-----------------------------------+
| HackTool:Win32/Mimikatz.D             | High     | Tool                | file:_C:\Users\L.Ackerman\Documents\mimikatz.exe                                                                                                                                                                | Quarantine     | 2024-06-07 11:48:50.899367300 UTC |
+---------------------------------------+----------+---------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+-----------------------------------+
| VirTool:MSIL/Kekeo!atmn               | Severe   | Tool                | file:_C:\Users\L.Ackerman\Documents\Rubeus.exe; process:_pid:5480,ProcessStart:133622364887807555                                                                                                               | Quarantine     | 2024-06-07 12:21:46.903276400 UTC |
+---------------------------------------+----------+---------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+-----------------------------------+
| VirTool:MSIL/Kekeo.C                  | Severe   | Tool                | file:_C:\Users\L.Ackerman\Documents\Rubeus.exe; process:_pid:5480,ProcessStart:133622364887807555                                                                                                               | Allow          | 2024-06-07 12:21:46.916400 UTC    |
+---------------------------------------+----------+---------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+-----------------------------------+
| VirTool:MSIL/Kekeo!atmn               | Severe   | Tool                | file:_C:\Users\L.Ackerman\Documents\Rubeus.exe                                                                                                                                                                  | Not Applicable | 2024-06-07 12:21:46.918307700 UTC |
+---------------------------------------+----------+---------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+-----------------------------------+
| VirTool:MSIL/Kekeo!atmn               | Severe   | Tool                | file:_C:\Users\L.Ackerman\Documents\Rubeus.exe                                                                                                                                                                  | Quarantine     | 2024-06-07 12:21:47.279806500 UTC |
+---------------------------------------+----------+---------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+-----------------------------------+
| Ransom:Win32/ContiCrypt.PL!MTB        | Severe   | Ransomware          | amsi:_\Device\HarddiskVolume3\Windows\System32\WindowsPowerShell\v1.0\powershell.exe                                                                                                                            | Not Applicable | 2024-04-21 09:41:02.050732900 UTC |
+---------------------------------------+----------+---------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+-----------------------------------+
| Ransom:Win32/ContiCrypt.PL!MTB        | Severe   | Ransomware          | amsi:_\Device\HarddiskVolume3\Windows\System32\WindowsPowerShell\v1.0\powershell.exe                                                                                                                            | Quarantine     | 2024-04-21 09:41:21.140124800 UTC |
+---------------------------------------+----------+---------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+-----------------------------------+
| Trojan:PowerShell/Fleisnam.D          | Severe   | Trojan              | amsi:_\Device\HarddiskVolume3\Windows\System32\WindowsPowerShell\v1.0\powershell.exe                                                                                                                            | Not Applicable | 2024-04-21 09:42:07.805639 UTC    |
+---------------------------------------+----------+---------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+-----------------------------------+
| Behavior:Win32/MaleficAms.F           | Severe   | Suspicious Behavior | behavior:_process: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe, pid:5372:41452614766796; process:_pid:5372,ProcessStart:133581660585673121                                                        | Not Applicable | 2024-04-21 09:42:14.947818400 UTC |
+---------------------------------------+----------+---------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------+-----------------------------------+

```