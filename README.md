# Rusty-Playground :crab:
> A collection of Rust programs showcasing some offensive-securtiy and evasions techniques

----

| Tool                | Description                                                                                                                                             | Reference(s)                                                                                                                                                                |
|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ClipboardMon        | Monitors the clipboard for changes and logs clipboard content or copies files depending on detected changes.                                                | -                                                                                                         |
| DumpMDEConfig    | Enumerates Microsoft Defender to identify exclusion paths, allowed threats, protection history, and ASR (Attack Surface Reduction) rules enabled on the system. No admin privileges required. | [Source](https://twitter.com/VakninHai/status/1796628601535652289)                                                                 |
| ElevateToken        | Impersonates user tokens to create processes with elevated system privileges.                                                                           | [Token::elevate](https://github.com/gentilkiwi/mimikatz/blob/master/mimikatz/modules/kuhl_m_token.c)                                                                  |
| HashMiner        | Extract NTLM Hashes from SAM and SYSTEM | [mimikatz-rs](https://github.com/0xRobert/mimikatz-rs) 
| HeapEnc             | Demonstrates a simple example of heap encryption.                                                                                                                       | [nimHeapEnc](https://github.com/nbaertsch/nimHeapEnc)                                                                                                                  |
| HideDll             | Hides DLLs in the current process and employs anti-analysis methods to prevent the DLL from being dumped by memory scanners.                      | -                                                                                                         |
| HookFinder          | Detects userland API hooks implemented by antivirus or EDR (Endpoint Detection and Response) software.                                                                                  | -                                                                                                         |
| IoDllProxyLoad      | Uses Windows thread pool API to proxy the loading and unloading of a DLL via an I/O completion callback function using named pipes.             | [IoDllProxyLoad](https://github.com/fin3ss3g0d/IoDllProxyLoad) <br> [weaponizing-windows-thread-pool-apis-proxying-dll-loads](https://fin3ss3g0d.net/index.php/2024/03/18/weaponizing-windows-thread-pool-apis-proxying-dll-loads/) |
| NtCreateUserProcess | Spawns processes using NtCreateUserProcess, blocks DLLs, and performs PPID (Parent Process ID) spoofing.                                                                                | [ntcreateuserprocess_1](https://offensivedefence.co.uk/posts/ntcreateuserprocess/) <br> [ntcreateuserprocess_2](https://captmeelo.com/redteam/maldev/2022/05/10/ntcreateuserprocess.html)                         |
| PatchlessAmsiBypass | Bypasses AMSI (Antimalware Scan Interface) utilizing hardware breakpoints, avoiding in-memory hooks.                                                                                                              | [patchless_amsi](https://gist.github.com/CCob/fe3b63d80890fafeca982f76c8a3efdf)                                                                                           |
| PatchlessBypass     | An improved version of PatchlessAmsiBypass, patches both ETW (Event Tracing for Windows) and AMSI on all threads.                                                                           | [PatchlessHook](https://github.com/ScriptIdiot/sleepmask_PatchlessHook/)                                                                                                   |
| SelfErase           | Deletes the currently running file from disk.                                                                                                                | [self_remove](https://github.com/Enelg52/OffensiveGo/tree/main/self_remove) <br> [delete-self-poc](https://github.com/LloydLabs/delete-self-poc)                        |
| SilentFart          | Uses NTAPI to retrieve NTDLL and unhooks it without triggering the "PspCreateProcessNotifyRoutine" callback.                                                         | [GhostFart](https://github.com/mansk1es/GhostFart)                                                                                                                   |
| StackEncrypt        | Shuffles and encrypts the stack, then sleeps using indirect syscalls to NtDelayExecution.                                                                        | [StackMask](https://github.com/WKL-Sec/StackMask)                                                                                                                      |
| UnhookNtdll         | Implements the Perun's Fart technique in Rust using NtCreateUserProcess, supporting both local and remote execution.                        | [arsenal-rs](https://github.com/memN0ps/arsenal-rs)                                                                                                                    |
| USB_mon             | Monitors USB devices and displays information about new devices connected to the system.                                                                                       | -                                                                                                         |
| VEH-ProxyDll        | Leverages the Vectored Exception Handler (VEH) to modify the context, particularly the RIP register, to invoke LoadLibraryA with the RCX register holding its argument (module name). Triggers exceptions using VirtualProtect to set pages to PAGE_GUARD. | [VEH-DLL-proxy-load.c](https://github.com/kleiton0x00/Proxy-DLL-Loads/blob/main/VEH-DLL-proxy-load.c)                                                                     |
| Whoami_alt          | Provides alternatives to the whoami command by utilizing uncommon WinAPI functions.                                                                                         | [WhoIsWho](https://github.com/MzHmO/WhoIsWho) <br> [WhoamiAlternatives](https://twitter.com/vxunderground/status/1720265558501794288)                                     |
| Whoami_alt2         | Additional alternatives to the whoami command, leveraging uncommon WinAPI functions.                                                                                         | [WhoIsWho](https://github.com/MzHmO/WhoIsWho) <br> [WhoamiAlternatives](https://twitter.com/vxunderground/status/1720265558501794288)                                     |
| Wifi-Dump           | Dumps WiFi passwords using WinAPI.                                                                                                                           | -                                                                                                         |





