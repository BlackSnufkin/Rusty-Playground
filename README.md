# Rusty-Playground :crab:
> Some Rust programs I wrote while learning Malware Development 

| Tool                | Description                                                                                                                                             | Reference(s)                                                                                                                                                                |
|---------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ClipboardMon        | A simple program to monitor the clipboard for changes. It logs clipboard content or copies files depending on the detected changes.                                                | -                                                                                                         |
| DumpMDEConfig    | This tool enumerates Microsoft Defender, It will identifying exclusion paths, allowed threats, protection history and ASR (Attack Surface Reduction) rules enabled on the system. No admin privileges required. | [Source](https://twitter.com/VakninHai/status/1796628601535652289)                                                                 |
| ElevateToken        | A tool for impersonating user tokens to create processes with elevated system privileges.                                                                           | [Token::elevate](https://github.com/gentilkiwi/mimikatz/blob/master/mimikatz/modules/kuhl_m_token.c)                                                                  |
| HeapEnc             | A simple example of heap encryption.                                                                                                                       | [nimHeapEnc](https://github.com/nbaertsch/nimHeapEnc)                                                                                                                  |
| HideDll             | A program that hides DLLs in the current process and uses anti-analysis methods to prevent the DLL from being dumped by memory scanners.                      | -                                                                                                         |
| HookFinder          | Rust code that detects userland API hooks implemented by antivirus or EDR (Endpoint Detection and Response) software.                                                                                  | -                                                                                                         |
| IoDllProxyLoad      | Utilizes Windows thread pool API to proxy the loading and unloading of a DLL via an I/O completion callback function using named pipes.             | [IoDllProxyLoad](https://github.com/fin3ss3g0d/IoDllProxyLoad) <br> [weaponizing-windows-thread-pool-apis-proxying-dll-loads](https://fin3ss3g0d.net/index.php/2024/03/18/weaponizing-windows-thread-pool-apis-proxying-dll-loads/) |
| NtCreateUserProcess | A tool to spawn processes using NtCreateUserProcess, blocking DLLs, and performing PPID (Parent Process ID) spoofing.                                                                                | [ntcreateuserprocess_1](https://offensivedefence.co.uk/posts/ntcreateuserprocess/) <br> [ntcreateuserprocess_2](https://captmeelo.com/redteam/maldev/2022/05/10/ntcreateuserprocess.html)                         |
| PatchlessAmsiBypass | An AMSI (Antimalware Scan Interface) bypass utilizing hardware breakpoints, avoiding in-memory hooks.                                                                                                              | [patchless_amsi](https://gist.github.com/CCob/fe3b63d80890fafeca982f76c8a3efdf)                                                                                           |
| PatchlessBypass     | An improved version of PatchlessAmsiBypass, which patches both ETW (Event Tracing for Windows) and AMSI on all threads.                                                                           | [PatchlessHook](https://github.com/ScriptIdiot/sleepmask_PatchlessHook/)                                                                                                   |
| SelfErase           | Deletes the currently running file from disk.                                                                                                                | [self_remove](https://github.com/Enelg52/OffensiveGo/tree/main/self_remove) <br> [delete-self-poc](https://github.com/LloydLabs/delete-self-poc)                        |
| SilentFart          | Uses NTAPI to retrieve NTDLL and unhook it without triggering the "PspCreateProcessNotifyRoutine" callback.                                                         | [GhostFart](https://github.com/mansk1es/GhostFart)                                                                                                                   |
| StackEncrypt        | Shuffles and encrypts the stack, then sleeps using indirect syscalls to NtDelayExecution.                                                                        | [StackMask](https://github.com/WKL-Sec/StackMask)                                                                                                                      |
| UnhookNtdll         | Rust implementation of the Perun's Fart technique using NtCreateUserProcess. Supports both local and remote execution.                        | [arsenal-rs](https://github.com/memN0ps/arsenal-rs)                                                                                                                    |
| USB_mon             | Monitors USB devices and displays information about new devices connected to the system.                                                                                       | -                                                                                                         |
| VEH-ProxyDll        | Leverages the Vectored Exception Handler (VEH) to modify the context, especially the RIP register, to invoke LoadLibraryA with the RCX register holding its argument (module name). Triggers exceptions using VirtualProtect to set pages to PAGE_GUARD. | [VEH-DLL-proxy-load.c](https://github.com/kleiton0x00/Proxy-DLL-Loads/blob/main/VEH-DLL-proxy-load.c)                                                                     |
| Whoami_alt          | Alternatives to the whoami command, utilizing uncommon WinAPI functions.                                                                                         | [WhoIsWho](https://github.com/MzHmO/WhoIsWho) <br> [WhoamiAlternatives](https://twitter.com/vxunderground/status/1720265558501794288)                                     |
| Whoami_alt2         | Additional alternatives to the whoami command, leveraging uncommon WinAPI functions.                                                                                         | [WhoIsWho](https://github.com/MzHmO/WhoIsWho) <br> [WhoamiAlternatives](https://twitter.com/vxunderground/status/1720265558501794288)                                     |
| Wifi-Dump           | Dumps WiFi passwords using WinAPI.                                                                                                                           | -                                                                                                         |
